import{r as u,j as t}from"./index-BeGCS1Mt.js";const j={hp:"HP",attack:"Ataque",defense:"Defensa","special-attack":"Ataque Especial","special-defense":"Defensa Especial",speed:"Velocidad"},J=1025,G="https://pokeapi.co/api/v2/pokemon/",k=new Map;function D(){try{const e=localStorage.getItem("qkk-cache");if(e){const s=JSON.parse(e);for(const n of Object.keys(s))k.set(Number(n),s[n])}}catch{}}function V(e){try{const s=localStorage.getItem("qkk-cache"),n=s?JSON.parse(s):{};n[String(e.id)]=e,localStorage.setItem("qkk-cache",JSON.stringify(n))}catch{}}async function A(e){if(k.has(e))return k.get(e);const s=await fetch(`${G}${e}`);if(!s.ok)throw new Error(`PokeAPI ${e} -> ${s.status}`);const n=await s.json(),a=o=>{var d;return((d=n.stats.find(c=>c.stat.name===o))==null?void 0:d.base_stat)??0},l={id:e,name:n.name,sprite:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${e}.png`,stats:{hp:a("hp"),attack:a("attack"),defense:a("defense"),"special-attack":a("special-attack"),"special-defense":a("special-defense"),speed:a("speed")}};return k.set(e,l),V(l),l}function B(e){let s=1;do s=Math.floor(Math.random()*J)+1;while(s===e);return s}D();const Q=2500,W=2500;function z(){const e=()=>{try{return JSON.parse(localStorage.getItem("qkk-best")||"{}")}catch{return{}}};return{getFor:a=>a?e()[a]??0:0,setFor:(a,l)=>{const o=e();return o[a]=Math.max(o[a]??0,l),localStorage.setItem("qkk-best",JSON.stringify(o)),o[a]}}}function H(){const[e,s]=u.useState(null),[n,a]=u.useState(null),[l,o]=u.useState(null),[d,c]=u.useState(!1),[x,g]=u.useState(0),[h,m]=u.useState("select"),[b,p]=u.useState(""),[w,y]=u.useState(!1),[$,N]=u.useState(null),[P,S]=u.useState(null),{getFor:R,setFor:I}=z();async function v(i){let r=0;for(;r<6;)try{const f=B(i);return await A(f)}catch{r++}return A(1)}async function _(i){s(i),g(0),p(""),m("playing"),c(!0),y(!1),N(null),S(null);const r=await v(),f=await v(r.id);a(r),o(f),c(!1)}async function F(i){if(c(!0),i==="left"&&n){const r=await v(n.id);o(r)}else if(i==="right"&&l){const r=await v(l.id);a(r)}y(!1),N(null),S(null),c(!1)}function C(i,r){return!i||!r?0:i.stats[r]}async function O(i){if(!e||!n||!l||d||w)return;const r=C(n,e),f=C(l,e);S(i),N({left:r,right:f}),y(!0);const E=r===f;E||(i==="left"?r>f:f>r)?(g(q=>q+1),p(E?"Â¡Empate! Cuenta como acierto. +1":"Â¡Correcto! +1"),window.setTimeout(async()=>{await F(i)},Q)):(p(`Â¡Fallaste! ${n.name} (${r}) vs ${l.name} (${f})`),I(e,x),window.setTimeout(()=>{m("gameover"),y(!1)},W))}function L(){m("select"),s(null),a(null),o(null),g(0),p(""),y(!1),N(null),S(null)}const T=u.useMemo(()=>R(e),[e]);return{stat:e,left:n,right:l,loading:d,score:x,mode:h,msg:b,revealing:w,revealValues:$,selectedSide:P,best:T,startGame:_,choose:O,resetAll:L}}function U(){const{stat:e,left:s,right:n,loading:a,score:l,mode:o,msg:d,revealing:c,revealValues:x,selectedSide:g,best:h,startGame:m,choose:b,resetAll:p}=H();return t.jsxs("section",{className:"space-y-6",children:[t.jsx("h2",{className:"text-3xl md:text-4xl font-bold",children:"ðŸŽ® Minijuego â€” Â¿QuiÃ©n tiene mÃ¡sâ€¦?"}),o==="select"&&t.jsxs("div",{className:"glass rounded-2xl p-6",children:[t.jsx("p",{className:"text-neutral-300 mb-4",children:"Elige una estadÃ­stica para jugar:"}),t.jsx("div",{className:"flex flex-wrap gap-3",children:Object.keys(j).map(w=>t.jsx("button",{onClick:()=>m(w),className:"rounded-xl px-4 py-2 font-semibold bg-white text-neutral-900 hover:opacity-90 transition",children:j[w]},w))})]}),o==="playing"&&e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["EstadÃ­stica: ",t.jsx("strong",{children:j[e]})]}),t.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["PuntuaciÃ³n: ",t.jsx("strong",{children:l})]}),t.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["Mejor ",j[e],": ",t.jsx("strong",{children:h})]})]}),d&&t.jsx("div",{className:"text-sm text-neutral-300",children:d}),t.jsxs("div",{className:`grid md:grid-cols-2 gap-6 ${c?"pointer-events-none":""}`,children:[t.jsx(M,{side:"left",pokemon:s,statKey:e,disabled:a||c,selected:g==="left",revealValues:x,onChoose:()=>b("left"),label:"CampeÃ³n actual"}),t.jsx(M,{side:"right",pokemon:n,statKey:e,disabled:a||c,selected:g==="right",revealValues:x,onChoose:()=>b("right")})]}),t.jsx("p",{className:"text-xs text-neutral-400",children:"Consejo: piensa rÃ¡pido; los valores se revelan tras tu elecciÃ³n y luego llega el siguiente rival."})]}),o==="gameover"&&e&&t.jsxs("div",{className:"glass rounded-2xl p-6 space-y-4",children:[t.jsx("h3",{className:"text-2xl font-bold",children:"Fin de la partida"}),t.jsxs("p",{className:"text-neutral-300",children:["EstadÃ­stica: ",t.jsx("strong",{children:j[e]})," Â· PuntuaciÃ³n total:"," ",t.jsx("strong",{children:l})," Â· Mejor: ",t.jsx("strong",{children:h})]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsx("button",{onClick:()=>m(e),className:"rounded-xl px-4 py-2 font-semibold bg-white text-neutral-900 hover:opacity-90 transition",children:"Jugar de nuevo"}),t.jsx("button",{onClick:p,className:"rounded-xl px-4 py-2 font-semibold glass hover:bg-white/10 transition",children:"Cambiar estadÃ­stica"})]})]})]})}function M({side:e,pokemon:s,statKey:n,onChoose:a,disabled:l,selected:o,label:d,revealValues:c}){const x=c?e==="left"?c.left:c.right:null,g=c?e==="left"?c.right:c.left:null,h=typeof x=="number"&&typeof g=="number",m=h&&x===g,b=h&&!m&&x>g,p=h?m?"ring-1 ring-yellow-400/60":b?"ring-1 ring-emerald-400/70":"ring-1 ring-rose-400/70":o?"ring-1 ring-white/40":"";return t.jsxs("div",{className:`glass rounded-2xl p-5 flex flex-col items-center text-center ${p}`,children:[d&&t.jsx("span",{className:"text-xs text-neutral-400 mb-2",children:d}),t.jsx("img",{src:s==null?void 0:s.sprite,alt:(s==null?void 0:s.name)||"PokÃ©mon",className:"w-40 h-40 object-contain drop-shadow-[0_10px_25px_rgba(0,0,0,.35)] select-none",draggable:!1}),t.jsx("h4",{className:"mt-3 text-lg font-semibold capitalize",children:(s==null?void 0:s.name)??"..."}),t.jsxs("div",{className:"mt-1 text-sm text-neutral-400",children:["Â¿QuiÃ©n tiene mÃ¡s ",t.jsx("strong",{className:"text-neutral-200",children:j[n]}),"?"]}),t.jsxs("div",{className:`mt-3 text-sm px-3 py-1 rounded-full border ${h?"bg-white/10 border-white/20":"bg-white/5 border-white/10"}`,children:[j[n],": ",t.jsx("span",{className:"tracking-widest",children:h?x:"???"})]}),t.jsx("button",{onClick:a,disabled:l,className:`mt-4 inline-flex rounded-xl px-4 py-2 font-semibold transition ${l?"glass cursor-not-allowed":"bg-white text-neutral-900 hover:opacity-90"}`,children:"Elegir"})]})}export{U as default};
