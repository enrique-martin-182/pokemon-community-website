import{r as d,j as e}from"./index-BJT7qsCn.js";import{r as J,f as R,S as j}from"./pokeapi-GAYqqnrw.js";const q=2500,B=2500;function Q(){const t=()=>{try{return JSON.parse(localStorage.getItem("qkk-best")||"{}")}catch{return{}}};return{getFor:l=>l?t()[l]??0:0,setFor:(l,r)=>{const i=t();return i[l]=Math.max(i[l]??0,r),localStorage.setItem("qkk-best",JSON.stringify(i)),i[l]}}}function V(){const[t,n]=d.useState(null),[o,l]=d.useState(null),[r,i]=d.useState(null),[f,a]=d.useState(!1),[u,x]=d.useState(0),[g,m]=d.useState("select"),[b,p]=d.useState(""),[N,y]=d.useState(!1),[M,w]=d.useState(null),[_,S]=d.useState(null),{getFor:$,setFor:A}=Q();async function v(c){let s=0;for(;s<6;)try{const h=J(c);return await R(h)}catch{s++}return R(1)}async function L(c){n(c),x(0),p(""),m("playing"),a(!0),y(!1),w(null),S(null);const s=await v(),h=await v(s.id);l(s),i(h),a(!1)}async function T(c){if(a(!0),c==="left"&&o){const s=await v(o.id);i(s)}else if(c==="right"&&r){const s=await v(r.id);l(s)}y(!1),w(null),S(null),a(!1)}function C(c,s){return!c||!s?0:c.stats[s]}async function P(c){if(!t||!o||!r||f||N)return;const s=C(o,t),h=C(r,t);S(c),w({left:s,right:h}),y(!0);const E=s===h;E||(c==="left"?s>h:h>s)?(x(I=>I+1),p(E?"Â¡Empate! Cuenta como acierto. +1":"Â¡Correcto! +1"),window.setTimeout(async()=>{await T(c)},q)):(p(`Â¡Fallaste! ${o.name} (${s}) vs ${r.name} (${h})`),A(t,u),window.setTimeout(()=>{m("gameover"),y(!1)},B))}function G(){m("select"),n(null),l(null),i(null),x(0),p(""),y(!1),w(null),S(null)}const O=d.useMemo(()=>$(t),[t]);return{stat:t,left:o,right:r,loading:f,score:u,mode:g,msg:b,revealing:N,revealValues:M,selectedSide:_,best:O,startGame:L,choose:P,resetAll:G}}function D(){const{stat:t,left:n,right:o,loading:l,score:r,mode:i,msg:f,revealing:a,revealValues:u,selectedSide:x,best:g,startGame:m,choose:b,resetAll:p}=V();return e.jsxs("section",{className:"space-y-6",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold",children:"ðŸŽ® Minijuego â€” Â¿QuiÃ©n tiene mÃ¡sâ€¦?"}),i==="select"&&e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("p",{className:"text-neutral-300 mb-4",children:"Elige una estadÃ­stica para jugar:"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.keys(j).map(N=>e.jsx("button",{onClick:()=>m(N),className:"rounded-xl px-4 py-2 font-semibold bg-white text-neutral-900 hover:opacity-90 transition",children:j[N]},N))})]}),i==="playing"&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["EstadÃ­stica: ",e.jsx("strong",{children:j[t]})]}),e.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["PuntuaciÃ³n: ",e.jsx("strong",{children:r})]}),e.jsxs("span",{className:"text-sm px-3 py-1 rounded-full glass",children:["Mejor ",j[t],": ",e.jsx("strong",{children:g})]})]}),f&&e.jsx("div",{className:"text-sm text-neutral-300",children:f}),e.jsxs("div",{className:`grid md:grid-cols-2 gap-6 ${a?"pointer-events-none":""}`,children:[e.jsx(F,{side:"left",pokemon:n,statKey:t,disabled:l||a,selected:x==="left",revealValues:u,onChoose:()=>b("left"),label:"CampeÃ³n actual"}),e.jsx(F,{side:"right",pokemon:o,statKey:t,disabled:l||a,selected:x==="right",revealValues:u,onChoose:()=>b("right")})]}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Consejo: piensa rÃ¡pido; los valores se revelan tras tu elecciÃ³n y luego llega el siguiente rival."})]}),i==="gameover"&&t&&e.jsxs("div",{className:"glass rounded-2xl p-6 space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Fin de la partida"}),e.jsxs("p",{className:"text-neutral-300",children:["EstadÃ­stica: ",e.jsx("strong",{children:j[t]})," Â· PuntuaciÃ³n total:"," ",e.jsx("strong",{children:r})," Â· Mejor: ",e.jsx("strong",{children:g})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:()=>m(t),className:"rounded-xl px-4 py-2 font-semibold bg-white text-neutral-900 hover:opacity-90 transition",children:"Jugar de nuevo"}),e.jsx("button",{onClick:p,className:"rounded-xl px-4 py-2 font-semibold glass hover:bg-white/10 transition",children:"Cambiar estadÃ­stica"})]})]})]})}function F({side:t,pokemon:n,statKey:o,onChoose:l,disabled:r,selected:i,label:f,revealValues:a}){const u=a?t==="left"?a.left:a.right:null,x=a?t==="left"?a.right:a.left:null,g=typeof u=="number"&&typeof x=="number",m=g&&u===x,b=g&&!m&&u>x,p=g?m?"ring-1 ring-yellow-400/60":b?"ring-1 ring-emerald-400/70":"ring-1 ring-rose-400/70":i?"ring-1 ring-white/40":"";return e.jsxs("div",{className:`glass rounded-2xl p-5 flex flex-col items-center text-center ${p}`,children:[f&&e.jsx("span",{className:"text-xs text-neutral-400 mb-2",children:f}),e.jsx("img",{src:n==null?void 0:n.sprite,alt:(n==null?void 0:n.name)||"PokÃ©mon",className:"w-40 h-40 object-contain drop-shadow-[0_10px_25px_rgba(0,0,0,.35)] select-none",draggable:!1}),e.jsx("h4",{className:"mt-3 text-lg font-semibold capitalize",children:(n==null?void 0:n.name)??"..."}),e.jsxs("div",{className:"mt-1 text-sm text-neutral-400",children:["Â¿QuiÃ©n tiene mÃ¡s ",e.jsx("strong",{className:"text-neutral-200",children:j[o]}),"?"]}),e.jsxs("div",{className:`mt-3 text-sm px-3 py-1 rounded-full border ${g?"bg-white/10 border-white/20":"bg-white/5 border-white/10"}`,children:[j[o],": ",e.jsx("span",{className:"tracking-widest",children:g?u:"???"})]}),e.jsx("button",{onClick:l,disabled:r,className:`mt-4 inline-flex rounded-xl px-4 py-2 font-semibold transition ${r?"glass cursor-not-allowed":"bg-white text-neutral-900 hover:opacity-90"}`,children:"Elegir"})]})}export{D as default};
